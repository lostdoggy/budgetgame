<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Warrior: Financial Apocalypse Simulator</title>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #ff3366;
            --secondary: #ffcc00;
            --success: #00ff88;
            --danger: #ff0044;
            --dark: #0a0e27;
            --darker: #050714;
            --light: #ffffff;
        }

        body {
            font-family: 'Roboto Condensed', sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 50%, #1a0f2e 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, rgba(255,51,102,0.2) 0%, rgba(255,204,0,0.2) 100%);
            border-radius: 20px;
            border: 3px solid var(--primary);
            margin-bottom: 30px;
            box-shadow: 0 0 50px rgba(255,51,102,0.5);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 50px rgba(255,51,102,0.5); }
            50% { box-shadow: 0 0 80px rgba(255,51,102,0.8); }
        }

        h1 {
            font-family: 'Bangers', cursive;
            font-size: 4rem;
            color: var(--primary);
            text-shadow: 0 0 20px var(--secondary), 0 5px 0 #000;
            letter-spacing: 3px;
            margin-bottom: 10px;
            animation: neon 1.5s ease-in-out infinite alternate;
        }

        @keyframes neon {
            from { text-shadow: 0 0 20px var(--secondary), 0 5px 0 #000; }
            to { text-shadow: 0 0 40px var(--secondary), 0 0 60px var(--primary), 0 5px 0 #000; }
        }

        .subtitle {
            font-size: 1.5rem;
            color: var(--secondary);
            font-weight: bold;
            text-transform: uppercase;
        }

        .player-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(10,14,39,0.9) 0%, rgba(26,15,46,0.9) 100%);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(255,51,102,0.3);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--light);
            text-shadow: 0 0 10px var(--primary);
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(0,0,0,0.5);
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid var(--secondary);
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, var(--secondary) 100%);
            border-radius: 15px;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 120px;
            padding: 15px 20px;
            background: rgba(10,14,39,0.8);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: var(--light);
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tab:hover {
            background: rgba(255,51,102,0.3);
            transform: scale(1.05);
        }

        .tab.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            box-shadow: 0 0 30px rgba(255,51,102,0.8);
            animation: tabGlow 2s infinite;
        }

        @keyframes tabGlow {
            0%, 100% { box-shadow: 0 0 30px rgba(255,51,102,0.8); }
            50% { box-shadow: 0 0 50px rgba(255,204,0,0.8); }
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel {
            background: linear-gradient(135deg, rgba(10,14,39,0.95) 0%, rgba(26,15,46,0.95) 100%);
            border: 3px solid var(--primary);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.7);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            color: var(--secondary);
            font-weight: bold;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input, select {
            width: 100%;
            padding: 12px;
            background: rgba(0,0,0,0.5);
            border: 2px solid var(--primary);
            border-radius: 10px;
            color: var(--light);
            font-size: 1rem;
            font-family: 'Roboto Condensed', sans-serif;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 20px rgba(255,204,0,0.5);
        }

        button {
            background: linear-gradient(135deg, var(--primary) 0%, var(--danger) 100%);
            color: var(--light);
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 5px 20px rgba(255,51,102,0.5);
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255,51,102,0.8);
        }

        button:active {
            transform: translateY(-1px);
        }

        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,51,102,0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .transaction-item:hover {
            background: rgba(255,51,102,0.2);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .boss-battle {
            background: linear-gradient(135deg, rgba(255,0,68,0.3) 0%, rgba(138,0,230,0.3) 100%);
            border: 3px solid var(--danger);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            animation: bossPulse 1s infinite;
        }

        @keyframes bossPulse {
            0%, 100% { box-shadow: 0 0 50px rgba(255,0,68,0.5); }
            50% { box-shadow: 0 0 80px rgba(255,0,68,0.9); }
        }

        .boss-name {
            font-family: 'Bangers', cursive;
            font-size: 3rem;
            color: var(--danger);
            text-shadow: 0 0 30px var(--danger);
            margin-bottom: 20px;
        }

        .boss-health {
            height: 40px;
            background: rgba(0,0,0,0.7);
            border-radius: 20px;
            overflow: hidden;
            border: 3px solid var(--danger);
            margin: 20px 0;
        }

        .boss-health-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--danger) 0%, var(--primary) 100%);
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .achievement {
            background: linear-gradient(135deg, rgba(0,255,136,0.2) 0%, rgba(255,204,0,0.2) 100%);
            border: 2px solid var(--success);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .achievement-icon {
            font-size: 2rem;
        }

        .achievement.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }

        .spin-wheel {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 30px auto;
            border-radius: 50%;
            border: 5px solid var(--secondary);
            background: conic-gradient(
                var(--primary) 0deg 60deg,
                var(--secondary) 60deg 120deg,
                var(--success) 120deg 180deg,
                var(--danger) 180deg 240deg,
                #8a00e6 240deg 300deg,
                #00ffff 300deg 360deg
            );
            animation: spinIdle 20s linear infinite;
        }

        @keyframes spinIdle {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .spin-wheel.spinning {
            animation: spinFast 3s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }

        @keyframes spinFast {
            from { transform: rotate(0deg); }
            to { transform: rotate(1800deg); }
        }

        .spin-pointer {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid var(--secondary);
            filter: drop-shadow(0 0 10px var(--secondary));
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--secondary);
            animation: confettiFall 3s linear;
            z-index: 1000;
        }

        @keyframes confettiFall {
            from {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background: linear-gradient(135deg, var(--dark) 0%, var(--darker) 100%);
            border: 3px solid var(--primary);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 0 100px rgba(255,51,102,0.8);
            animation: scaleIn 0.5s;
        }

        @keyframes scaleIn {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-title {
            font-family: 'Bangers', cursive;
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 20px;
            text-shadow: 0 0 20px var(--secondary);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                width: 100%;
            }
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .category-card {
            background: rgba(0,0,0,0.4);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255,51,102,0.3);
        }

        .category-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        .category-spent {
            font-size: 2rem;
            color: var(--light);
            margin-bottom: 10px;
        }

        .category-budget {
            font-size: 1rem;
            color: rgba(255,255,255,0.6);
            margin-bottom: 15px;
        }

        .damage-text {
            position: fixed;
            font-family: 'Bangers', cursive;
            font-size: 3rem;
            color: var(--danger);
            text-shadow: 0 0 20px var(--danger);
            pointer-events: none;
            z-index: 9999;
            animation: damageFloat 2s ease-out forwards;
        }

        @keyframes damageFloat {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(1.5);
                opacity: 0;
            }
        }

        .budget-setting-item {
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,51,102,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            display: grid;
            grid-template-columns: 1fr 150px;
            gap: 20px;
            align-items: center;
        }

        .budget-setting-item:hover {
            border-color: var(--primary);
            background: rgba(255,51,102,0.1);
        }

        .budget-setting-label {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--light);
        }

        .budget-setting-input {
            padding: 10px;
            background: rgba(0,0,0,0.5);
            border: 2px solid var(--secondary);
            border-radius: 8px;
            color: var(--light);
            font-size: 1.1rem;
            font-weight: bold;
            text-align: center;
        }

        .budget-setting-input:focus {
            outline: none;
            border-color: var(--success);
            box-shadow: 0 0 15px rgba(0,255,136,0.5);
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    
    <div class="container">
        <header>
            <h1>BUDGET WARRIOR</h1>
            <p class="subtitle">Financial Apocalypse Simulator</p>
        </header>

        <div class="player-stats">
            <div class="stat-card">
                <div class="stat-label">Player Level</div>
                <div class="stat-value" id="playerLevel">1</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="xpBar" style="width: 0%">0 XP</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Savings Power</div>
                <div class="stat-value" id="savingsAmount">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Damage Dealt</div>
                <div class="stat-value" id="damageDealt">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Win Streak</div>
                <div class="stat-value" id="winStreak">0</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('battle')">‚öîÔ∏è BATTLE</div>
            <div class="tab" onclick="switchTab('transactions')">üí∞ LOOT LOG</div>
            <div class="tab" onclick="switchTab('achievements')">üèÜ ACHIEVEMENTS</div>
            <div class="tab" onclick="switchTab('dailySpin')">üé∞ DAILY SPIN</div>
            <div class="tab" onclick="switchTab('categories')">üìä ENEMY INTEL</div>
            <div class="tab" onclick="switchTab('settings')">‚öôÔ∏è SETTINGS</div>
        </div>

        <div id="battle" class="tab-content active">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px;">ADD TRANSACTION (DEAL DAMAGE)</h2>
                <div class="input-group">
                    <label>Category (Enemy Type)</label>
                    <select id="category">
                        <option value="Shopping">Shopping Boss</option>
                        <option value="Dining">Dining Demon</option>
                        <option value="Groceries">Grocery Golem</option>
                        <option value="Transportation">Transport Titan</option>
                        <option value="Home Improvement">Home Improvement Hydra</option>
                        <option value="Healthcare">Healthcare Horror</option>
                        <option value="Professional">Professional Phantom</option>
                        <option value="Utilities">Utility Overlord</option>
                        <option value="Miscellaneous">Mystery Monster</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Amount (Damage Points)</label>
                    <input type="number" id="amount" placeholder="Enter amount" step="0.01">
                </div>
                <div class="input-group">
                    <label>Description (Battle Notes)</label>
                    <input type="text" id="description" placeholder="What did you buy?">
                </div>
                <button onclick="addTransaction()" style="width: 100%; margin-top: 10px;">ATTACK! üí•</button>
            </div>

            <div id="bossContainer"></div>
        </div>

        <div id="transactions" class="tab-content">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px;">BATTLE LOG</h2>
                <div class="transaction-list" id="transactionList"></div>
            </div>
        </div>

        <div id="achievements" class="tab-content">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px;">ACHIEVEMENTS UNLOCKED</h2>
                <div id="achievementList"></div>
            </div>
        </div>

        <div id="dailySpin" class="tab-content">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px; text-align: center;">DAILY FORTUNE WHEEL</h2>
                <div style="position: relative;">
                    <div class="spin-pointer"></div>
                    <div class="spin-wheel" id="spinWheel"></div>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="spinWheel()" id="spinButton" style="font-size: 1.5rem; padding: 20px 40px;">
                        SPIN FOR LOOT! üé∞
                    </button>
                    <p id="spinResult" style="margin-top: 20px; font-size: 1.5rem; color: var(--secondary);"></p>
                </div>
            </div>
        </div>

        <div id="categories" class="tab-content">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px;">ENEMY STATUS</h2>
                <div class="category-grid" id="categoryGrid"></div>
            </div>
        </div>

        <div id="settings" class="tab-content">
            <div class="panel">
                <h2 style="color: var(--secondary); margin-bottom: 20px;">‚öôÔ∏è GAME SETTINGS</h2>
                
                <div style="margin-bottom: 40px;">
                    <h3 style="color: var(--secondary); margin-bottom: 15px; font-size: 1.5rem;">Budget Configuration</h3>
                    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                        Adjust your monthly budget for each category. Changes take effect immediately!
                    </p>
                    
                    <div id="budgetSettings"></div>
                    
                    <button onclick="saveBudgetSettings()" style="margin-top: 20px; width: 100%;">
                        üíæ SAVE BUDGET SETTINGS
                    </button>
                </div>

                <div style="margin-bottom: 40px; padding-top: 40px; border-top: 2px solid var(--primary);">
                    <h3 style="color: var(--danger); margin-bottom: 15px; font-size: 1.5rem;">‚ö†Ô∏è DANGER ZONE</h3>
                    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                        Warning: These actions cannot be undone!
                    </p>
                    
                    <button onclick="confirmReset('spending')" style="background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%); margin-bottom: 10px; width: 100%;">
                        üîÑ RESET CURRENT SPENDING
                    </button>
                    
                    <button onclick="confirmReset('all')" style="background: linear-gradient(135deg, var(--danger) 0%, #8a00e6 100%); width: 100%;">
                        üíÄ RESET ENTIRE GAME
                    </button>
                </div>

                <div style="padding-top: 40px; border-top: 2px solid var(--primary);">
                    <h3 style="color: var(--secondary); margin-bottom: 15px; font-size: 1.5rem;">üì§ EXPORT/IMPORT DATA</h3>
                    <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                        Save your game data or restore from a backup.
                    </p>
                    
                    <button onclick="exportData()" style="background: linear-gradient(135deg, var(--success) 0%, var(--secondary) 100%); margin-bottom: 10px; width: 100%;">
                        üì• EXPORT GAME DATA
                    </button>
                    
                    <button onclick="document.getElementById('importFile').click()" style="background: linear-gradient(135deg, var(--secondary) 0%, var(--success) 100%); width: 100%;">
                        üì§ IMPORT GAME DATA
                    </button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="victoryModal">
        <div class="modal-content">
            <h2 class="modal-title">VICTORY!</h2>
            <p style="font-size: 1.5rem; margin-bottom: 20px;" id="victoryMessage"></p>
            <button onclick="closeModal()">CONTINUE</button>
        </div>
    </div>

    <div class="modal" id="defeatModal">
        <div class="modal-content">
            <h2 class="modal-title" style="color: var(--danger);">BUDGET BREACHED!</h2>
            <p style="font-size: 1.5rem; margin-bottom: 20px;" id="defeatMessage"></p>
            <button onclick="closeModal()">RETREAT</button>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            level: 1,
            xp: 0,
            xpToNextLevel: 100,
            totalSavings: 0,
            damageDealt: 0,
            winStreak: 0,
            lastSpinDate: null,
            transactions: [],
            budgets: {
                'Shopping': 500,
                'Dining': 150,
                'Groceries': 540,
                'Transportation': 150,
                'Home Improvement': 200,
                'Healthcare': 356,
                'Professional': 396,
                'Utilities': 756,
                'Miscellaneous': 200
            },
            spending: {
                'Shopping': 0,
                'Dining': 0,
                'Groceries': 0,
                'Transportation': 0,
                'Home Improvement': 0,
                'Healthcare': 0,
                'Professional': 0,
                'Utilities': 0,
                'Miscellaneous': 0
            },
            achievements: {
                'First Blood': false,
                'Budget Slayer': false,
                'Century Warrior': false,
                'Level 5 Legend': false,
                'Perfect Week': false,
                'Savings Master': false
            }
        };

        // Initialize
        function init() {
            loadGameState();
            createStars();
            updateDisplay();
            updateBosses();
            updateAchievements();
            updateCategories();
            checkDailySpin();
        }

        function createStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            if (tabName === 'categories') {
                updateCategories();
            }
            if (tabName === 'settings') {
                updateBudgetSettings();
            }
        }

        function addTransaction() {
            const category = document.getElementById('category').value;
            const amount = parseFloat(document.getElementById('amount').value);
            const description = document.getElementById('description').value;

            if (!amount || amount <= 0) {
                alert('Enter a valid amount!');
                return;
            }

            const transaction = {
                id: Date.now(),
                category,
                amount,
                description,
                date: new Date().toISOString()
            };

            gameState.transactions.unshift(transaction);
            gameState.spending[category] += amount;
            gameState.damageDealt += Math.floor(amount);

            // Calculate savings (if under budget)
            const totalSpent = Object.values(gameState.spending).reduce((a, b) => a + b, 0);
            const totalBudget = Object.values(gameState.budgets).reduce((a, b) => a + b, 0);
            gameState.totalSavings = Math.max(0, totalBudget - totalSpent);

            // XP and leveling
            const xpGained = Math.floor(amount / 10);
            gameState.xp += xpGained;

            if (gameState.xp >= gameState.xpToNextLevel) {
                levelUp();
            }

            // Check if over budget
            if (gameState.spending[category] > gameState.budgets[category]) {
                gameState.winStreak = 0;
                showDefeat(category, gameState.spending[category], gameState.budgets[category]);
                showDamageText(amount);
            } else {
                gameState.winStreak++;
                checkVictory(category);
                createConfetti();
            }

            checkAchievements();
            updateDisplay();
            updateBosses();
            updateCategories();
            saveGameState();

            // Clear inputs
            document.getElementById('amount').value = '';
            document.getElementById('description').value = '';
        }

        function showDamageText(amount) {
            const damageText = document.createElement('div');
            damageText.className = 'damage-text';
            damageText.textContent = `-$${amount.toFixed(2)}`;
            damageText.style.left = Math.random() * 80 + 10 + '%';
            damageText.style.top = Math.random() * 50 + 25 + '%';
            document.body.appendChild(damageText);
            
            setTimeout(() => damageText.remove(), 2000);
        }

        function levelUp() {
            gameState.level++;
            gameState.xp = 0;
            gameState.xpToNextLevel = Math.floor(gameState.xpToNextLevel * 1.5);
            
            showModal('victoryModal', `LEVEL UP! You are now Level ${gameState.level}!`, 'üéâ +50 XP BONUS! üéâ');
            createMassiveConfetti();
        }

        function checkVictory(category) {
            const spent = gameState.spending[category];
            const budget = gameState.budgets[category];
            const remaining = budget - spent;

            if (remaining < budget * 0.1 && remaining > 0) {
                showModal('victoryModal', 
                    `CLOSE CALL!`,
                    `You're at ${((spent/budget)*100).toFixed(0)}% of your ${category} budget!`);
            }
        }

        function showDefeat(category, spent, budget) {
            const overage = spent - budget;
            showModal('defeatModal',
                `${category} Boss has defeated you!`,
                `You went over by $${overage.toFixed(2)}!`);
        }

        function showModal(modalId, title, message) {
            document.getElementById(modalId).classList.add('active');
            document.getElementById(modalId === 'victoryModal' ? 'victoryMessage' : 'defeatMessage').textContent = message;
        }

        function closeModal() {
            document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
        }

        function updateDisplay() {
            document.getElementById('playerLevel').textContent = gameState.level;
            document.getElementById('savingsAmount').textContent = '$' + gameState.totalSavings.toFixed(2);
            document.getElementById('damageDealt').textContent = gameState.damageDealt;
            document.getElementById('winStreak').textContent = gameState.winStreak;

            const xpPercent = (gameState.xp / gameState.xpToNextLevel) * 100;
            document.getElementById('xpBar').style.width = xpPercent + '%';
            document.getElementById('xpBar').textContent = `${gameState.xp} / ${gameState.xpToNextLevel} XP`;

            updateTransactionList();
        }

        function updateTransactionList() {
            const list = document.getElementById('transactionList');
            list.innerHTML = '';

            gameState.transactions.slice(0, 20).forEach(t => {
                const item = document.createElement('div');
                item.className = 'transaction-item';
                item.innerHTML = `
                    <div>
                        <div style="font-weight: bold; color: var(--secondary);">${t.category}</div>
                        <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7);">${t.description || 'No description'}</div>
                        <div style="font-size: 0.8rem; color: rgba(255,255,255,0.5);">${new Date(t.date).toLocaleDateString()}</div>
                    </div>
                    <div style="font-size: 1.5rem; font-weight: bold; color: var(--danger);">
                        -$${t.amount.toFixed(2)}
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function updateBosses() {
            const container = document.getElementById('bossContainer');
            container.innerHTML = '';

            Object.entries(gameState.budgets).forEach(([category, budget]) => {
                const spent = gameState.spending[category];
                const healthPercent = Math.max(0, ((budget - spent) / budget) * 100);
                const isDefeated = spent > budget;

                const boss = document.createElement('div');
                boss.className = 'boss-battle';
                boss.style.marginBottom = '20px';
                boss.innerHTML = `
                    <div class="boss-name">${category} Boss</div>
                    <div style="font-size: 1.2rem; margin-bottom: 10px;">
                        ${isDefeated ? 'üíÄ DEFEATED üíÄ' : 'üëπ ACTIVE üëπ'}
                    </div>
                    <div class="boss-health">
                        <div class="boss-health-fill" style="width: ${healthPercent}%">
                            $${(budget - spent).toFixed(2)} / $${budget.toFixed(2)}
                        </div>
                    </div>
                    <div style="font-size: 1.1rem; margin-top: 10px;">
                        Spent: $${spent.toFixed(2)} | Remaining: $${(budget - spent).toFixed(2)}
                    </div>
                `;
                container.appendChild(boss);
            });
        }

        function updateCategories() {
            const grid = document.getElementById('categoryGrid');
            grid.innerHTML = '';

            Object.entries(gameState.budgets).forEach(([category, budget]) => {
                const spent = gameState.spending[category];
                const remaining = budget - spent;
                const percent = (spent / budget) * 100;

                const card = document.createElement('div');
                card.className = 'category-card';
                card.innerHTML = `
                    <div class="category-name">${category}</div>
                    <div class="category-spent">$${spent.toFixed(2)}</div>
                    <div class="category-budget">Budget: $${budget.toFixed(2)}</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.min(percent, 100)}%; background: ${percent > 100 ? 'var(--danger)' : 'linear-gradient(90deg, var(--success) 0%, var(--secondary) 100%)'}">
                            ${percent.toFixed(0)}%
                        </div>
                    </div>
                    <div style="margin-top: 10px; color: ${remaining < 0 ? 'var(--danger)' : 'var(--success)'}; font-weight: bold;">
                        ${remaining < 0 ? 'OVER' : 'Remaining'}: $${Math.abs(remaining).toFixed(2)}
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function checkAchievements() {
            const achievements = gameState.achievements;

            if (gameState.transactions.length >= 1 && !achievements['First Blood']) {
                achievements['First Blood'] = true;
                gameState.xp += 50;
            }

            if (gameState.damageDealt >= 100 && !achievements['Century Warrior']) {
                achievements['Century Warrior'] = true;
                gameState.xp += 100;
            }

            if (gameState.level >= 5 && !achievements['Level 5 Legend']) {
                achievements['Level 5 Legend'] = true;
                gameState.xp += 200;
            }

            if (gameState.winStreak >= 7 && !achievements['Perfect Week']) {
                achievements['Perfect Week'] = true;
                gameState.xp += 150;
            }

            if (gameState.totalSavings >= 500 && !achievements['Savings Master']) {
                achievements['Savings Master'] = true;
                gameState.xp += 300;
            }

            const allUnderBudget = Object.entries(gameState.spending).every(([cat, spent]) => 
                spent <= gameState.budgets[cat]
            );
            if (allUnderBudget && gameState.transactions.length > 0 && !achievements['Budget Slayer']) {
                achievements['Budget Slayer'] = true;
                gameState.xp += 250;
            }

            updateAchievements();
        }

        function updateAchievements() {
            const list = document.getElementById('achievementList');
            list.innerHTML = '';

            const achievementData = {
                'First Blood': { icon: '‚öîÔ∏è', desc: 'Make your first transaction' },
                'Century Warrior': { icon: 'üíØ', desc: 'Deal 100+ damage points' },
                'Level 5 Legend': { icon: '‚≠ê', desc: 'Reach Level 5' },
                'Perfect Week': { icon: 'üî•', desc: 'Maintain 7-day win streak' },
                'Savings Master': { icon: 'üí∞', desc: 'Save $500+' },
                'Budget Slayer': { icon: 'üèÜ', desc: 'Stay under budget in all categories' }
            };

            Object.entries(gameState.achievements).forEach(([name, unlocked]) => {
                const data = achievementData[name];
                const achievement = document.createElement('div');
                achievement.className = 'achievement' + (unlocked ? '' : ' locked');
                achievement.innerHTML = `
                    <div class="achievement-icon">${data.icon}</div>
                    <div style="flex: 1;">
                        <div style="font-weight: bold; font-size: 1.2rem; color: var(--secondary);">${name}</div>
                        <div style="color: rgba(255,255,255,0.7);">${data.desc}</div>
                    </div>
                    <div style="font-size: 1.5rem;">
                        ${unlocked ? '‚úÖ' : 'üîí'}
                    </div>
                `;
                list.appendChild(achievement);
            });
        }

        function checkDailySpin() {
            const today = new Date().toDateString();
            const lastSpin = gameState.lastSpinDate;

            if (lastSpin !== today) {
                document.getElementById('spinButton').disabled = false;
                document.getElementById('spinButton').style.opacity = '1';
            } else {
                document.getElementById('spinButton').disabled = true;
                document.getElementById('spinButton').style.opacity = '0.5';
                document.getElementById('spinResult').textContent = 'Come back tomorrow!';
            }
        }

        function spinWheel() {
            const today = new Date().toDateString();
            
            if (gameState.lastSpinDate === today) {
                return;
            }

            const wheel = document.getElementById('spinWheel');
            wheel.classList.add('spinning');

            setTimeout(() => {
                wheel.classList.remove('spinning');
                const rewards = [
                    { text: '+100 XP', value: 100, type: 'xp' },
                    { text: '+$50 Budget Boost', value: 50, type: 'budget' },
                    { text: '+5 Damage', value: 5, type: 'damage' },
                    { text: '+2 Win Streak', value: 2, type: 'streak' },
                    { text: 'Level Up!', value: 1, type: 'level' },
                    { text: 'Mystery Bonus!', value: 0, type: 'mystery' }
                ];

                const reward = rewards[Math.floor(Math.random() * rewards.length)];
                applyReward(reward);
                
                gameState.lastSpinDate = today;
                checkDailySpin();
                saveGameState();
            }, 3000);
        }

        function applyReward(reward) {
            let message = reward.text;

            switch(reward.type) {
                case 'xp':
                    gameState.xp += reward.value;
                    break;
                case 'budget':
                    Object.keys(gameState.budgets).forEach(cat => {
                        gameState.budgets[cat] += reward.value;
                    });
                    break;
                case 'damage':
                    gameState.damageDealt += reward.value;
                    break;
                case 'streak':
                    gameState.winStreak += reward.value;
                    break;
                case 'level':
                    levelUp();
                    break;
                case 'mystery':
                    gameState.xp += 50;
                    gameState.totalSavings += 25;
                    message = 'Mystery Bonus: +50 XP & +$25 Savings!';
                    break;
            }

            document.getElementById('spinResult').textContent = message;
            updateDisplay();
            createMassiveConfetti();
        }

        function createConfetti() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = ['#ff3366', '#ffcc00', '#00ff88', '#00ffff'][Math.floor(Math.random() * 4)];
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 50);
            }
        }

        function createMassiveConfetti() {
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = ['#ff3366', '#ffcc00', '#00ff88', '#00ffff', '#8a00e6'][Math.floor(Math.random() * 5)];
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 20);
            }
        }

        function saveGameState() {
            localStorage.setItem('budgetWarriorState', JSON.stringify(gameState));
        }

        function loadGameState() {
            const saved = localStorage.getItem('budgetWarriorState');
            if (saved) {
                const loaded = JSON.parse(saved);
                gameState = { ...gameState, ...loaded };
            }
        }

        function updateBudgetSettings() {
            const container = document.getElementById('budgetSettings');
            container.innerHTML = '';

            Object.entries(gameState.budgets).forEach(([category, budget]) => {
                const item = document.createElement('div');
                item.className = 'budget-setting-item';
                item.innerHTML = `
                    <div class="budget-setting-label">${category}</div>
                    <input type="number" 
                           class="budget-setting-input" 
                           id="budget-${category}" 
                           value="${budget}" 
                           min="0" 
                           step="10">
                `;
                container.appendChild(item);
            });
        }

        function saveBudgetSettings() {
            let changed = false;
            Object.keys(gameState.budgets).forEach(category => {
                const input = document.getElementById(`budget-${category}`);
                const newValue = parseFloat(input.value);
                if (newValue && newValue > 0 && newValue !== gameState.budgets[category]) {
                    gameState.budgets[category] = newValue;
                    changed = true;
                }
            });

            if (changed) {
                saveGameState();
                updateDisplay();
                updateBosses();
                updateCategories();
                createConfetti();
                showModal('victoryModal', 'Settings Saved!', 'Your budget has been updated!');
            }
        }

        function confirmReset(type) {
            const messages = {
                spending: 'Reset all current spending to $0? Your transactions will be cleared but your level and achievements will remain.',
                all: 'RESET ENTIRE GAME? This will delete everything including your level, XP, achievements, and all progress. This cannot be undone!'
            };

            if (confirm(messages[type])) {
                if (type === 'spending') {
                    resetSpending();
                } else {
                    resetAll();
                }
            }
        }

        function resetSpending() {
            Object.keys(gameState.spending).forEach(cat => {
                gameState.spending[cat] = 0;
            });
            gameState.transactions = [];
            saveGameState();
            updateDisplay();
            updateBosses();
            updateCategories();
            showModal('victoryModal', 'Spending Reset!', 'All spending has been cleared. Fresh start!');
        }

        function resetAll() {
            localStorage.removeItem('budgetWarriorState');
            location.reload();
        }

        function exportData() {
            const dataStr = JSON.stringify(gameState, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `budget-warrior-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
            
            createConfetti();
            showModal('victoryModal', 'Data Exported!', 'Your game data has been saved to a file!');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    gameState = { ...gameState, ...imported };
                    saveGameState();
                    updateDisplay();
                    updateBosses();
                    updateCategories();
                    updateAchievements();
                    createMassiveConfetti();
                    showModal('victoryModal', 'Data Imported!', 'Your game data has been restored successfully!');
                } catch (error) {
                    alert('Error importing file. Please make sure it\'s a valid Budget Warrior backup file.');
                }
            };
            reader.readAsText(file);
            
            // Reset the file input
            event.target.value = '';
        }

        // Initialize on load
        init();
    </script>
</body>
</html>
